"use strict";angular.module("fbLinkerApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ui.router","ui.bootstrap"]).config(["$stateProvider","$urlRouterProvider",function(a,b){a.state("setup",{url:"/setup",templateUrl:"views/main.html",controller:"SetupController"}).state("setup.sources",{url:"/sources",templateUrl:"views/setup.html"}).state("setup.index",{url:"/index",templateUrl:"views/indexing.html",controller:"MailIndexingController"}).state("setup.done",{url:"/done",templateUrl:"views/done.html"}).state("mail",{url:"/mail",templateUrl:"views/mail.html",controller:"MailController"}).state("mail.view",{url:"/:id",templateUrl:"views/mail-view.html",controller:"MailViewController"}),b.otherwise("/setup/sources")}]),angular.module("fbLinkerApp").controller("MainController",["$scope","$state",function(a,b){a.inSetup=function(){return b.includes("setup.*")}}]).controller("SetupController",["$scope","$state","$http","$window",function(a,b,c){a.auths=[],a.hasAuth=function(b){return-1!==a.auths.indexOf(b)},a.checkAuths=function(){c.get("http://auth.getcomposure.com/auths").success(function(b){a.auths=b.auths})},a.$watch("auths",function(){a.hasAuth("gmail")&&a.hasAuth("linkedin")&&b.go("setup.index")}),a.checkAuths()}]).controller("MailController",["$scope","$state","$http",function(a,b,c){a.selectedIndex=0,Mousetrap.bind("up",function(){a.$apply(function(){a.selectedIndex=Math.max(0,a.selectedIndex-1)})}),Mousetrap.bind("down",function(){a.$apply(function(){a.selectedIndex=Math.min(a.selectedIndex+1,a.rows.length-1)})}),a.$watch("selectedIndex",function(){a.rows.length&&a.viewEmail(a.rows[a.selectedIndex])}),a.rows=[],c.get("http://auth.getcomposure.com:9200/docs/_search",{params:{size:50}}).success(function(b){a.rows=b.hits.hits.map(function(a){return{text:a._source.text,id:a._id,mentions:a._source.mentions}})}),a.viewEmail=function(a){b.go("mail.view",{id:a.id})}}]).controller("MailViewController",["$scope","$stateParams",function(a,b){a.mailId=b.id,a.bl=b}]).controller("MailIndexingController",["$scope","$timeout","$http",function(a,b,c){a.progress=40,b(function(){c.get("http://localhost:9000/progress").success(function(b){a.progress=b.progress})},500)}]),angular.module("fbLinkerApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]);